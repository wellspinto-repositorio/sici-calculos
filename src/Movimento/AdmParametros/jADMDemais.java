package Movimento.AdmParametros;

import Funcoes.Dates;
import Funcoes.Db;
import Funcoes.FuncoesGlobais;
import Funcoes.LerValor;
import Funcoes.TableControl;
import Funcoes.VariaveisGlobais;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Date;
import javax.swing.JOptionPane;

public class jADMDemais extends javax.swing.JPanel {
    Db conn = VariaveisGlobais.conexao;
    String regras = "";

    /**
     * Creates new form jADMDemais
     */
    public jADMDemais() {
        initComponents();
        LerCampos();
        
        new SimpleThread().start();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel15 = new javax.swing.JPanel();
        jLabel26 = new javax.swing.JLabel();
        extMax = new javax.swing.JFormattedTextField();
        btextMax = new javax.swing.JButton();
        jPanel9 = new javax.swing.JPanel();
        jLabel17 = new javax.swing.JLabel();
        c_vrmaxch = new javax.swing.JFormattedTextField();
        c_btgravar = new javax.swing.JButton();
        jPanel10 = new javax.swing.JPanel();
        jScrollPane2 = new javax.swing.JScrollPane();
        jFeriados = new javax.swing.JTable();
        jDia = new javax.swing.JSpinner();
        jMes = new javax.swing.JSpinner();
        btAdc = new javax.swing.JButton();
        jbtDel = new javax.swing.JButton();
        jDesc = new javax.swing.JTextField();
        jTipo = new javax.swing.JSpinner();
        jDiasAnt = new javax.swing.JSpinner();
        jbarra = new javax.swing.JProgressBar();
        jPanel13 = new javax.swing.JPanel();
        jLabel22 = new javax.swing.JLabel();
        jspReajNumero = new javax.swing.JSpinner();
        jcbReajTipo = new javax.swing.JComboBox();
        jbtReajuste = new javax.swing.JButton();

        setMaximumSize(new java.awt.Dimension(772, 314));
        setMinimumSize(new java.awt.Dimension(772, 314));

        jPanel15.setBorder(javax.swing.BorderFactory.createTitledBorder("Extratos a Depositos"));

        jLabel26.setText("Valor Minimo:");

        extMax.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#,##0.00"))));
        extMax.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        extMax.setText("0,00");

        btextMax.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Figuras/ok.png"))); // NOI18N
        btextMax.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btextMaxActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel15Layout = new javax.swing.GroupLayout(jPanel15);
        jPanel15.setLayout(jPanel15Layout);
        jPanel15Layout.setHorizontalGroup(
            jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel15Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel15Layout.createSequentialGroup()
                        .addComponent(jLabel26)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(jPanel15Layout.createSequentialGroup()
                        .addComponent(extMax)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btextMax, javax.swing.GroupLayout.PREFERRED_SIZE, 36, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
        );
        jPanel15Layout.setVerticalGroup(
            jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel15Layout.createSequentialGroup()
                .addComponent(jLabel26)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel15Layout.createSequentialGroup()
                        .addComponent(btextMax)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addComponent(extMax))
                .addContainerGap())
        );

        jPanel9.setBorder(javax.swing.BorderFactory.createTitledBorder("Emissão de Cheques"));

        jLabel17.setText("Valor Máximo por Cheque emitido:");

        c_vrmaxch.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#,##0.00"))));
        c_vrmaxch.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        c_vrmaxch.setText("0,00");

        c_btgravar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Figuras/ok.png"))); // NOI18N
        c_btgravar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c_btgravarActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel9Layout = new javax.swing.GroupLayout(jPanel9);
        jPanel9.setLayout(jPanel9Layout);
        jPanel9Layout.setHorizontalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jLabel17)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel9Layout.createSequentialGroup()
                        .addComponent(c_vrmaxch)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(c_btgravar)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel9Layout.setVerticalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addComponent(jLabel17)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(c_btgravar, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(c_vrmaxch))
                .addContainerGap(8, Short.MAX_VALUE))
        );

        jPanel10.setBorder(javax.swing.BorderFactory.createTitledBorder("Feriados e dias sem funcionamento"));

        jFeriados.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {

            }
        ));
        jFeriados.setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
        jFeriados.getTableHeader().setReorderingAllowed(false);
        jFeriados.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jFeriadosMouseClicked(evt);
            }
        });
        jScrollPane2.setViewportView(jFeriados);

        jDia.setModel(new javax.swing.SpinnerNumberModel(1, 1, 31, 1));
        jDia.setEditor(new javax.swing.JSpinner.NumberEditor(jDia, "00"));

        jMes.setModel(new javax.swing.SpinnerListModel(new String[] {"Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"}));

        btAdc.setText("+");
        btAdc.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btAdcActionPerformed(evt);
            }
        });

        jbtDel.setText("-");
        jbtDel.setEnabled(false);
        jbtDel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jbtDelActionPerformed(evt);
            }
        });

        jTipo.setModel(new javax.swing.SpinnerListModel(new String[] {"Feriado", "Anuncio", "Não Abriu"}));

        jDiasAnt.setModel(new javax.swing.SpinnerNumberModel(0, 0, 30, 1));
        jDiasAnt.setToolTipText("Dias anteriores no qual o anuncio começara a aparecer.");
        jDiasAnt.setEditor(new javax.swing.JSpinner.NumberEditor(jDiasAnt, "00"));

        javax.swing.GroupLayout jPanel10Layout = new javax.swing.GroupLayout(jPanel10);
        jPanel10.setLayout(jPanel10Layout);
        jPanel10Layout.setHorizontalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jbarra, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(jPanel10Layout.createSequentialGroup()
                        .addComponent(jScrollPane2)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(btAdc, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(jbtDel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                    .addGroup(jPanel10Layout.createSequentialGroup()
                        .addComponent(jDia, javax.swing.GroupLayout.PREFERRED_SIZE, 46, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jMes, javax.swing.GroupLayout.PREFERRED_SIZE, 107, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jDesc, javax.swing.GroupLayout.PREFERRED_SIZE, 281, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(7, 7, 7)
                        .addComponent(jTipo, javax.swing.GroupLayout.DEFAULT_SIZE, 228, Short.MAX_VALUE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jDiasAnt, javax.swing.GroupLayout.PREFERRED_SIZE, 51, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
        );
        jPanel10Layout.setVerticalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel10Layout.createSequentialGroup()
                        .addComponent(btAdc)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jbtDel)
                        .addGap(29, 29, 29))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel10Layout.createSequentialGroup()
                        .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jDia, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jMes, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jDesc, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jTipo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jDiasAnt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jbarra, javax.swing.GroupLayout.PREFERRED_SIZE, 12, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        jPanel13.setBorder(javax.swing.BorderFactory.createTitledBorder("Reajuste de Aluguel"));

        jLabel22.setText("Avisar no Recibo/Boleta com:");

        jcbReajTipo.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Meses" }));

        jbtReajuste.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Figuras/ok.png"))); // NOI18N
        jbtReajuste.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jbtReajusteActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel13Layout = new javax.swing.GroupLayout(jPanel13);
        jPanel13.setLayout(jPanel13Layout);
        jPanel13Layout.setHorizontalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel13Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel13Layout.createSequentialGroup()
                        .addComponent(jspReajNumero, javax.swing.GroupLayout.PREFERRED_SIZE, 62, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jcbReajTipo, javax.swing.GroupLayout.PREFERRED_SIZE, 90, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jbtReajuste, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel13Layout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 1, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel22, javax.swing.GroupLayout.PREFERRED_SIZE, 213, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
        );
        jPanel13Layout.setVerticalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel13Layout.createSequentialGroup()
                .addComponent(jLabel22, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jbtReajuste, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jcbReajTipo)
                    .addComponent(jspReajNumero, javax.swing.GroupLayout.Alignment.LEADING))
                .addGap(6, 6, 6))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jPanel10, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jPanel9, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel13, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel15, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(jPanel13, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel9, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel15, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel10, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );
    }// </editor-fold>//GEN-END:initComponents

    private void btextMaxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btextMaxActionPerformed
        try {
            String prvarch = FuncoesGlobais.GravaValor(extMax.getText().trim());
            conn.SaveParameters(new String[] {"EXTMAX",prvarch,"TEXTO"});
        } catch (Exception ex) {ex.printStackTrace();}
    }//GEN-LAST:event_btextMaxActionPerformed

    private void c_btgravarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c_btgravarActionPerformed
        try {
            String prvarch = FuncoesGlobais.GravaValor(c_vrmaxch.getText().trim());
            conn.SaveParameters(new String[] {"MAXCH",prvarch,"TEXTO"});
        } catch (Exception ex) {ex.printStackTrace();}
    }//GEN-LAST:event_c_btgravarActionPerformed

    private void jFeriadosMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jFeriadosMouseClicked
        int prows = jFeriados.getRowCount();
        jbtDel.setEnabled(prows > 0);
    }//GEN-LAST:event_jFeriadosMouseClicked

    private void btAdcActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btAdcActionPerformed
        String pdia = FuncoesGlobais.StrZero(jDia.getValue().toString(),2);
        String tmes = jMes.getValue().toString();
        String pmes = null;
        if (tmes.equalsIgnoreCase("janeiro")) {
            pmes = "01";
        } else if (tmes.equalsIgnoreCase("fevereiro")) {
            pmes = "02";
        } else if (tmes.equalsIgnoreCase("março")) {
            pmes = "03";
        } else if (tmes.equalsIgnoreCase("abril")) {
            pmes = "04";
        } else if (tmes.equalsIgnoreCase("maio")) {
            pmes = "05";
        } else if (tmes.equalsIgnoreCase("junho")) {
            pmes = "06";
        } else if (tmes.equalsIgnoreCase("julho")) {
            pmes = "07";
        } else if (tmes.equalsIgnoreCase("agosto")) {
            pmes = "08";
        } else if (tmes.equalsIgnoreCase("setembro")) {
            pmes = "09";
        } else if (tmes.equalsIgnoreCase("outubro")) {
            pmes = "10";
        } else if (tmes.equalsIgnoreCase("novembro")) {
            pmes = "11";
        } else if (tmes.equalsIgnoreCase("dezembro")) {
            pmes = "12";
        }

        String ttipo = jTipo.getValue().toString();
        String ptipo;
        if (ttipo.equalsIgnoreCase("feriado")) {
            ptipo = "F";
        } else if (ttipo.equalsIgnoreCase("anuncio")) {
            ptipo = "A";
        }  else {
            ptipo = "N";
        }

        String pdesc = jDesc.getText();
        String pdias = FuncoesGlobais.StrZero(jDiasAnt.getValue().toString(),2);
        String pano = Dates.DateFormata("yyyy/MM/dd",new Date()).substring(0, 4);

        if (TableControl.seek(jFeriados, 0, pdia + "-" + pmes + "-" + pano) < 0) {
            String sql = "INSERT INTO feriados (dia, mes, descricao, tipo, dias) VALUES ('&1.','&2.','&3.','&4.','&5.');";
            sql = FuncoesGlobais.Subst(sql, new String[] {pdia, pmes, pdesc, ptipo, pdias });
            try { conn.CommandExecute(sql); } catch (Exception ex) {}

            String pdata = pdia + "-" + pmes + "-" + pano;
            TableControl.add(jFeriados, new String[][]{{pdata, pdesc, ptipo, pdias},{"C","L","C","C"}}, true);
        } else {
            JOptionPane.showMessageDialog(null, "Data já cadastrada!!!", "Atenção", JOptionPane.INFORMATION_MESSAGE);
        }

    }//GEN-LAST:event_btAdcActionPerformed

    private void jbtDelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jbtDelActionPerformed
        String sql = "DELETE FROM feriados WHERE dia = '&1.' AND mes = '&2.'";
        int prow = jFeriados.getSelectedRow();
        String pdia = jFeriados.getValueAt(prow, 0).toString().substring(0,2);
        String pmes = jFeriados.getValueAt(prow, 0).toString().substring(3,5);
        sql = FuncoesGlobais.Subst(sql, new String[] {pdia, pmes});
        try { conn.CommandExecute(sql); } catch (Exception ex) {}
        jbtDel.setEnabled(false);
        TableControl.del(jFeriados, prow);
    }//GEN-LAST:event_jbtDelActionPerformed

    private void jbtReajusteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jbtReajusteActionPerformed
        try {
            String[][] param = {{"REAJNUM","NUMERICO",jspReajNumero.getValue().toString()},
                {"REAJTIPO","TEXTO",jcbReajTipo.getSelectedItem().toString().trim().toUpperCase()}};
            conn.GravarMultiParametros(param);
        } catch (Exception ex) {ex.printStackTrace();}
    }//GEN-LAST:event_jbtReajusteActionPerformed

    private void LerCampos() {
        // Dados Reajuste
        try {
            jspReajNumero.setValue(Integer.parseInt(conn.ReadParameters("REAJNUM")));
        } catch (Exception ex) {
            jspReajNumero.setValue(0);
        }
        try {
            jcbReajTipo.getModel().setSelectedItem(conn.ReadParameters("REAJTIPO"));
        } catch (Exception ex) {
            jcbReajTipo.setSelectedIndex(0);
        }
        
        try {c_vrmaxch.setText(LerValor.FormatNumber(conn.ReadParameters("MAXCH"),2));} catch (Exception ex) {c_vrmaxch.setText("0,00");}        
        try {extMax.setText(LerValor.FormatNumber(conn.ReadParameters("EXTMAX"),2));} catch (Exception ex) {extMax.setText("0,00");}        
        try {regras = conn.ReadParameters("REGRAS");} catch (Exception ex) {}
        VariaveisGlobais.ccampos = "";        
    }
    
    class SimpleThread extends Thread {
        public SimpleThread() {
        }
        public void run() {
            ListaFeriados();
        }
    }

    private void ListaFeriados() {
        String sql = "SELECT dia, mes, descricao, tipo, dias FROM feriados ORDER BY dia, mes;";

        TableControl.Clear(jFeriados);
        // Seta Cabecario
        TableControl.header(jFeriados, new String[][] {{"Data", "Descrição",
                                      "Tipo", "dias"},{"80","300","100","30"}});

        ResultSet rs = conn.OpenTable(sql, null);
        try {
            jbarra.setValue(0);
            int eof = conn.RecordCount(rs); int pos = 1;
            rs.beforeFirst();
            while (rs.next()) {
                int br = (pos++ * 100) / eof;
                jbarra.setValue(br + 1);
                
                String pdia = rs.getString("dia");
                String pmes = rs.getString("mes");
                String pano = Dates.DateFormata("yyyy/MM/dd",new Date()).substring(0, 4);
                String pdata = FuncoesGlobais.StrZero(pdia, 2) + "-" + FuncoesGlobais.StrZero(pmes, 2) + "-" + FuncoesGlobais.StrZero(pano, 4);
                String pdesc = rs.getString("descricao");
                String ptipo = rs.getString("tipo");
                String pdias = rs.getString("dias");
                TableControl.add(jFeriados, new String[][]{{pdata, pdesc, ptipo, pdias},{"C","L","C","C"}}, true);
            }
        } catch (SQLException ex) {ex.printStackTrace();}
        conn.CloseTable(rs);
        jbarra.setValue(100);
    }
        
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btAdc;
    private javax.swing.JButton btextMax;
    private javax.swing.JButton c_btgravar;
    private javax.swing.JFormattedTextField c_vrmaxch;
    private javax.swing.JFormattedTextField extMax;
    private javax.swing.JTextField jDesc;
    private javax.swing.JSpinner jDia;
    private javax.swing.JSpinner jDiasAnt;
    private javax.swing.JTable jFeriados;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel26;
    private javax.swing.JSpinner jMes;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel13;
    private javax.swing.JPanel jPanel15;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JSpinner jTipo;
    private javax.swing.JProgressBar jbarra;
    private javax.swing.JButton jbtDel;
    private javax.swing.JButton jbtReajuste;
    private javax.swing.JComboBox jcbReajTipo;
    private javax.swing.JSpinner jspReajNumero;
    // End of variables declaration//GEN-END:variables
}
